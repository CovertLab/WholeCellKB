(function(e){function n(){return!!document.createElement("canvas").getContext}function r(){if(!n()){return false}var e=document.createElement("canvas");var t=e.getContext("2d");return typeof t.fillText=="function"}function i(){var e=document.createElement("div");return typeof e.style.MozTransition!="undefined"||typeof e.style.OTransition!="undefined"||typeof e.style.webkitTransition!="undefined"||typeof e.style.transition!="undefined"}function s(e,t,n,r,i){this.axisName=e;this.position=t;this.padding=n;this.plot=r;this.opts=i;this.width=0;this.height=0}function o(e,t,n,r,i){s.prototype.constructor.call(this,e,t,n,r,i)}function u(e,t,n,r,i){s.prototype.constructor.call(this,e,t,n,r,i);this.elem=null}function a(e,t,n,r,i){u.prototype.constructor.call(this,e,t,n,r,i)}function f(e,t,n,r,i){a.prototype.constructor.call(this,e,t,n,r,i);this.requiresResize=false}function l(t){t.hooks.processOptions.push(function(t,n){if(!n.axisLabels.show)return;var s=false;var l={};var c={left:0,right:0,top:0,bottom:0};var h=2;t.hooks.draw.push(function(t,n){var c=false;if(!s){e.each(t.getAxes(),function(e,n){var s=n.options||t.getOptions()[e];if(e in l){n.labelHeight=n.labelHeight-l[e].height;n.labelWidth=n.labelWidth-l[e].width;s.labelHeight=n.labelHeight;s.labelWidth=n.labelWidth;l[e].cleanup();delete l[e]}if(!s||!s.axisLabel||!n.show)return;c=true;var p=null;if(!s.axisLabelUseHtml&&navigator.appName=="Microsoft Internet Explorer"){var d=navigator.userAgent;var v=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(v.exec(d)!=null){rv=parseFloat(RegExp.$1)}if(rv>=9&&!s.axisLabelUseCanvas&&!s.axisLabelUseHtml){p=a}else if(!s.axisLabelUseCanvas&&!s.axisLabelUseHtml){p=f}else if(s.axisLabelUseCanvas){p=o}else{p=u}}else{if(s.axisLabelUseHtml||!i()&&!r()&&!s.axisLabelUseCanvas){p=u}else if(s.axisLabelUseCanvas||!i()){p=o}else{p=a}}var m=s.axisLabelPadding===undefined?h:s.axisLabelPadding;l[e]=new p(e,n.position,m,t,s);l[e].calculateSize();s.labelHeight=n.labelHeight+l[e].height;s.labelWidth=n.labelWidth+l[e].width});if(c){s=true;t.setupGrid();t.draw()}}else{s=false;e.each(t.getAxes(),function(e,n){var r=n.options||t.getOptions()[e];if(!r||!r.axisLabel||!n.show)return;l[e].draw(n.box)})}})})}var t={axisLabels:{show:true}};s.prototype.cleanup=function(){};o.prototype=new s;o.prototype.constructor=o;o.prototype.calculateSize=function(){if(!this.opts.axisLabelFontSizePixels)this.opts.axisLabelFontSizePixels=14;if(!this.opts.axisLabelFontFamily)this.opts.axisLabelFontFamily="sans-serif";var e=this.opts.axisLabelFontSizePixels+this.padding;var t=this.opts.axisLabelFontSizePixels+this.padding;if(this.position=="left"||this.position=="right"){this.width=this.opts.axisLabelFontSizePixels+this.padding;this.height=0}else{this.width=0;this.height=this.opts.axisLabelFontSizePixels+this.padding}};o.prototype.draw=function(e){if(!this.opts.axisLabelColour)this.opts.axisLabelColour="black";var t=this.plot.getCanvas().getContext("2d");t.save();t.font=this.opts.axisLabelFontSizePixels+"px "+this.opts.axisLabelFontFamily;t.fillStyle=this.opts.axisLabelColour;var n=t.measureText(this.opts.axisLabel).width;var r=this.opts.axisLabelFontSizePixels;var i,s,o=0;if(this.position=="top"){i=e.left+e.width/2-n/2;s=e.top+r*.72}else if(this.position=="bottom"){i=e.left+e.width/2-n/2;s=e.top+e.height-r*.72}else if(this.position=="left"){i=e.left+r*.72;s=e.height/2+e.top+n/2;o=-Math.PI/2}else if(this.position=="right"){i=e.left+e.width-r*.72;s=e.height/2+e.top-n/2;o=Math.PI/2}t.translate(i,s);t.rotate(o);t.fillText(this.opts.axisLabel,0,0);t.restore()};u.prototype=new s;u.prototype.constructor=u;u.prototype.calculateSize=function(){var t=e('<div class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(t);this.labelWidth=t.outerWidth(true);this.labelHeight=t.outerHeight(true);t.remove();this.width=this.height=0;if(this.position=="left"||this.position=="right"){this.width=this.labelWidth+this.padding}else{this.height=this.labelHeight+this.padding}};u.prototype.cleanup=function(){if(this.elem){this.elem.remove()}};u.prototype.draw=function(t){this.plot.getPlaceholder().find("#"+this.axisName+"Label").remove();this.elem=e('<div id="'+this.axisName+'Label" " class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(this.elem);if(this.position=="top"){this.elem.css("left",t.left+t.width/2-this.labelWidth/2+"px");this.elem.css("top",t.top+"px")}else if(this.position=="bottom"){this.elem.css("left",t.left+t.width/2-this.labelWidth/2+"px");this.elem.css("top",t.top+t.height-this.labelHeight+"px")}else if(this.position=="left"){this.elem.css("top",t.top+t.height/2-this.labelHeight/2+"px");this.elem.css("left",t.left+"px")}else if(this.position=="right"){this.elem.css("top",t.top+t.height/2-this.labelHeight/2+"px");this.elem.css("left",t.left+t.width-this.labelWidth+"px")}};a.prototype=new u;a.prototype.constructor=a;a.prototype.calculateSize=function(){u.prototype.calculateSize.call(this);this.width=this.height=0;if(this.position=="left"||this.position=="right"){this.width=this.labelHeight+this.padding}else{this.height=this.labelHeight+this.padding}};a.prototype.transforms=function(e,t,n){var r={"-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":""};if(t!=0||n!=0){var i=" translate("+t+"px, "+n+"px)";r["-moz-transform"]+=i;r["-webkit-transform"]+=i;r["-o-transform"]+=i;r["-ms-transform"]+=i}if(e!=0){var s=e/90;var o=" rotate("+e+"deg)";r["-moz-transform"]+=o;r["-webkit-transform"]+=o;r["-o-transform"]+=o;r["-ms-transform"]+=o}var u="top: 0; left: 0; ";for(var a in r){if(r[a]){u+=a+":"+r[a]+";"}}u+=";";return u};a.prototype.calculateOffsets=function(e){var t={x:0,y:0,degrees:0};if(this.position=="bottom"){t.x=e.left+e.width/2-this.labelWidth/2;t.y=e.top+e.height-this.labelHeight}else if(this.position=="top"){t.x=e.left+e.width/2-this.labelWidth/2;t.y=e.top}else if(this.position=="left"){t.degrees=-90;t.x=e.left-this.labelWidth/2+this.labelHeight/2;t.y=e.height/2+e.top}else if(this.position=="right"){t.degrees=90;t.x=e.left+e.width-this.labelWidth/2-this.labelHeight/2;t.y=e.height/2+e.top}return t};a.prototype.draw=function(t){this.plot.getPlaceholder().find("."+this.axisName+"Label").remove();var n=this.calculateOffsets(t);this.elem=e('<div class="axisLabels '+this.axisName+'Label" style="position:absolute; '+this.transforms(n.degrees,n.x,n.y)+'">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(this.elem)};f.prototype=new a;f.prototype.constructor=f;f.prototype.transforms=function(e,t,n){var r="";if(e!=0){var i=e/90;while(i<0){i+=4}r+=" filter: progid:DXImageTransform.Microsoft.BasicImage(rotation="+i+"); ";this.requiresResize=this.position=="right"}if(t!=0){r+="left: "+t+"px; "}if(n!=0){r+="top: "+n+"px; "}return r};f.prototype.calculateOffsets=function(e){var t=a.prototype.calculateOffsets.call(this,e);if(this.position=="top"){t.y=e.top+1}else if(this.position=="left"){t.x=e.left;t.y=e.height/2+e.top-this.labelWidth/2}else if(this.position=="right"){t.x=e.left+e.width-this.labelHeight;t.y=e.height/2+e.top-this.labelWidth/2}return t};f.prototype.draw=function(e){a.prototype.draw.call(this,e);if(this.requiresResize){this.elem=this.plot.getPlaceholder().find("."+this.axisName+"Label");this.elem.css("width",this.labelWidth);this.elem.css("height",this.labelHeight)}};e.plot.plugins.push({init:l,options:t,name:"axisLabels",version:"2.0"})})(jQuery)